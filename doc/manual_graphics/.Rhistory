p1_freq <- apply(p1,2,mean)
p2_freq <- apply(p2,2,mean)
p1_freq
p1_freq - p2_freq
sum((p1_freq - p2_freq)^2)
e1 <- sum((p1_freq - p2_freq)^2)
for(i in 1:nrow(p1)){for(j in 1:nrow(p2)){}}
for(i in 1:nrow(p1)){for(j in 1:nrow(p2)){sum((p1 - p2)^2)}}
for(i in 1:nrow(p1)){for(j in 1:nrow(p2)){sum((p1[i,] - p2[j,])^2)}}
ey <- c()
for(i in 1:nrow(p1)){for(j in 1:nrow(p2)){ey <- c(ey,sum((p1[i,] - p2[j,])^2))}}
ey
sum(ey)
sum(ey)/length(ey)
p1[1,]
p1[2,]
sample(c(1,0,1,0))
p1_freq
p2_fre
p2_freq
head(p1)
sample_individual <- function(){
ind <- rep(0,4)
ind[sample(1:4,2)] <- 1
}
rep(5,sample_individual())
sample_individual()
source('~/.active-rstudio-document')
sample_individual()
sample_individual()
sample_individual()
sample_individual()
sample_individual()
sample_individual()
sample_individual()
sample_individual()
sample_individual <- function(){
ind <- rep(0,4)
alleles <- sample(1:4,2,replace=T)
for(allele in aleles){
ind[allele] <- ind[allele] + 1
}
#ind[] <- 1
return(ind)
}
sample_individual()
sample_individual <- function(){
ind <- rep(0,4)
alleles <- sample(1:4,2,replace=T)
for(allele in alelles){
ind[allele] <- ind[allele] + 1
}
#ind[] <- 1
return(ind)
}
sample_individual()
source('~/.active-rstudio-document')
sample_individual()
source('~/.active-rstudio-document')
sample_individual()
sample_individual()
sample_individual()
sample_individual()
?repn
?sapply
replicate(5,sample_individual())
replicate(5,sample_individual
)
replicate(5,sample_individual())
t(replicate(5,sample_individual()))
c(sum(sample_sizes) - (sum(sample_sizes^2))/sum(sample_sizes))/(length(sample_sizes) - 1)
sample_sizes <- c(nrow(p1),nrow(p2))
nc <- c(sum(sample_sizes) - (sum(sample_sizes^2))/sum(sample_sizes))/(length(sample_sizes) - 1)
nc
p1 <- t(replicate(50,sample_individual()))
p2 <- t(replicate(75,sample_individual()))
#pop_list <- list(p1,p2)
sample_sizes <- c(nrow(p1),nrow(p2))
nc <- c(sum(sample_sizes) - (sum(sample_sizes^2))/sum(sample_sizes))/(length(sample_sizes) - 1)
nc
source('~/.active-rstudio-document')
MSD_ap
source('~/.active-rstudio-document')
MSD_ai_wp
source('~/.active-rstudio-document')
MSD_ai_wp
mean(MSD_ai_wp)
mean(MSD_ap)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
MSD_aim
MSD_ai
mean(MSD_ai)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
MSD_ai
source('~/.active-rstudio-document')
sigma_a
sigma_t
source('~/.active-rstudio-document')
sigma_a
sigma_t
source('~/.active-rstudio-document')
?sample
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
sigma_a
sigma_t
sigma_a/sigma_t
source('~/.active-rstudio-document')
sigma_a/sigma_t
sigma_a
sigma_t
p1
p2
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
dev.off()
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
sigma_a/sigma_t
sigma_a
sigma_t
nc
source('~/.active-rstudio-document')
sigma_a
sigma_t
source('~/.active-rstudio-document')
sigma_t
sigma_t
sigma_a
MSD_ap
MSD_ai_wp
p1[1,]
p1[2,]
p2[2,]
p2[1,]
source('~/.active-rstudio-document')
MSD_ap
MSD_ai_wp
MSD_ai
sigma_A
sigma_a
sigma_a
sigma_t
p2
p1
sigma_a
MSD_ai_wp
MSD_ai
sigma_a
sigma_t
source('~/.active-rstudio-document')
sigma_a
sigma_t
source('~/.active-rstudio-document')
sigma_a
sigma_t
source('~/.active-rstudio-document')
sigma_t
sigma_a
p1
source('~/.active-rstudio-document')
sigma_a
sigma_t
sigma_a/sigma_t
p1
p2
source('~/.active-rstudio-document')
sigma_a/sigma_t
source('~/.active-rstudio-document')
sigma_a/sigma_t
source('~/.active-rstudio-document')
sigma_a/sigma_t
source('~/.active-rstudio-document')
sigma_a/sigma_t
source('~/.active-rstudio-document')
sigma_a/sigma_t
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
sigma_a/sigma_t
p1
p2
MSD_ap
MSD_ai_wp
MSD_ap - MSD_ai_wp
c(MSD_ap - MSD_ai_wp)/MSD_ap
MSD_wi
MSD_ap
MSD_ai_wp
source('~/.active-rstudio-document')
MSD_ai_wp
MSD_ap
sigma_a
sigma_t
sigma_a/sigma_t
MSD_ai_wp
MSD_wi
source('~/.active-rstudio-document')
sigma_a/sigma_t
MSD_wi
MSD_wi <- 0
sigma_a <- (MSD_ap - MSD_ai_wp)/nc
sigma_t <- sigma_a + (MSD_ai_wp - MSD_wi)/2 + MSD_wi
sigma_a/sigma_t
source('~/.active-rstudio-document')
MSD_wi
MSD_ai_wp
source('~/.active-rstudio-document')
sigma_a
sigma_t
MSD_ap
MSD_ai_wp
source('~/.active-rstudio-document')
sigma_t
sigma_a
sigma_a/sigma-t
sigma_a/sigma_t
source('~/.active-rstudio-document')
sigma_a/sigma_t
sigma_a
sigma_t
MSD_ai
MSD_ap
p1[1,]
p2[1,]
abs(p1[1,] - p2[1,])
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
abs(p1[1,] - p2[1,])
sigma_a
sigma_t
sigma_a/sigma_t
source('~/.active-rstudio-document')
sigma_a/sigma_t
source('~/.active-rstudio-document')
sigma_a/sigma_t
source('~/.active-rstudio-document')
sigma_a/sigma_t
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
p1
p2
sigma_a
sigma_t
p2
MSD_wi
source('~/.active-rstudio-document')
sigma_a
sigma_t
source('~/.active-rstudio-document')
MSD_wi
MSD_ap
source('~/.active-rstudio-document')
sigma_a
MSD_wi
source('~/.active-rstudio-document')
MSD_wi
sigma_a
sigma_t
MSD_ap
MSD_ai_wp
source('~/.active-rstudio-document')
MSD_ai_wp
MSD_ap
MSD_wi
p1
source('~/.active-rstudio-document')
MSD_wi
MSD_ai_wp
MSD_ai_wp
MSD_wp
MSD_ap
MSD_ap
sample_individual <- function(probs=c(1,1,1,1),seqs=NULL){
if(!is.null(seqs)){
return(seqs)
}
ind <- rep(0,4)
alleles <- sample(1:4,2,replace=T,prob=probs)
#for(allele in alleles){
#  ind[allele] <- ind[allele] + 1
#}
#ind[] <- 1
#return(ind)
#ind[alleles] <- 1
#return(ind)
return(alleles)
}
replicate(5,sample_individual())
t(replicate(5,sample_individual()))
setdiff(c(4,4),c(3,3))
setdiff(c(4,4),c(3,4))
setdiff(c(1,2),c(3,4))
setdiff(c(4,4),c(3,4))
setdiff(c(3,4),c(4,4))
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
MSD_ap
p1
p2
source('~/.active-rstudio-document')
MSD_wi
MSD_ai_wp
MSD_ap
dist_metric(p1[1,])
dist_metric(p1[1,],p2[1,])
p1[1,]
p2[1,]
source('~/.active-rstudio-document')
p2[1,]
MSD_ap
source('~/.active-rstudio-document')
MSD_ap
o1
p1
sigma_a
sigma_t
MSD_ai
MSD_ai_wp
MSD_ap
nc
sigma_a/sigma_t
source('~/.active-rstudio-document')
sigma_a/sigma_t
p1
p2
MSD_ai
MSD_ai_wp
source('~/.active-rstudio-document')
sigma_a/sigma_t
MSD_wi
p1
p2
source('~/.active-rstudio-document')
sigma_a/sigma_t
source('~/.active-rstudio-document')
sigma_a/sigma_t
MSD_ap
MSD_ai_wp
MSD_wi
sigma_a
sigma_t
source('~/.active-rstudio-document')
sigma_a/sigma_t
source('~/.active-rstudio-document')
sigma_a/sigma_t
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
sigma_a/sigma_t
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
sigma_a/sigma_t
source('~/.active-rstudio-document')
sigma_a/sigma_t
MSD_ai_wp
MSD_wi
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
sigma_a/sigma_t
MSD_wi
MSD_ai_wp
MSD_ai_wp
p1[1,]
p1[2,]
dist_metric(p1[1,],p1[2,])
dist_metric(p1[1,],p1[1,])
dist_metric(p1[1,],p2[1,])
p1[1,]
p2[1,]
source('~/.active-rstudio-document')
sigma_a/sigma_t
source('~/.active-rstudio-document')
sigma_a/sigma_t
sigma_a/sigma_t
MSD_wi
MSD_ai_wp
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
MSD_ai_wp
sigma_a/sigma_t
MSD_wi
source('~/.active-rstudio-document')
sigma_a/sigma_t
p1
p2
apply(p1,1,mean)
apply(p1,2,mean)
apply(p2,2,mean)
source('~/.active-rstudio-document')
sigma_a/sigma_t
source('~/.active-rstudio-document')
sigma_a/sigma_t
source('~/.active-rstudio-document')
sigma_a/sigma_t
source('~/.active-rstudio-document')
sigma_a/sigma_t
p1
p2
MSD_ai
MSD_ai_wp
MSD_ap
t.test(rnorm(100),1)
t.test(rnorm(100),rnorm(2))
t.test(rnorm(100),rnorm(2))
t.test(rnorm(100),rnorm(2))
t.test(rnorm(100),rnorm(2))
t.test(rnorm(100),rnorm(2))
t.test(rnorm(100),rnorm(2))
t.test(rnorm(100),rnorm(2))
t.test(rnorm(100),rnorm(2))
replicate(t.test(rnorm(100),rnorm(2)),10)
replicate(10,t.test(rnorm(100),rnorm(2)))
replicate(10,t.test(rnorm(100),rnorm(2))$p.va)
replicate(10,t.test(rnorm(100),rnorm(2))$p.val)
min(replicate(10,t.test(rnorm(100),rnorm(2))$p.val))
min(replicate(10,t.test(rnorm(100),rnorm(2))$p.val))
min(replicate(10,t.test(rnorm(100),rnorm(2))$p.val))
7/8
1-7/8
(1-7/8)/2
1-(1-7/8)/2
factorial(16)
factorial(6)
#R <- sapply(0:1,function(theta){
#  c(cos(theta),-sin(theta),sin(theta),cos(theta))
#})
create_rotation_matrix <- function(i){
rbind(c(cos(i),-sin(i)),c(sin(i),cos(i)))
}
#R <- t(matrix(unlist(sapply(((1:reps)*2*pi)/reps,create_rotation_matrix,simplify=F)),nrow=2))
set.seed(11223344)
par(bg='black')
plot(NULL,
xlim=c(-10,10),
ylim=c(-10,10),
type='n',
axes=F,
xlab='',
ylab='')
# for(i in 1:10){
#   for(j in 1:50){
#     x <- 0
#     y <- 0
#     sign1 <- 1#runif(1,-1,1)#sample(c(-1,1),1)
#     sign2 <- 1#runif(1,-1,1)#sample(c(-1,1),1)
#     col1 <- rgb(1/(1+2^(rnorm(1,sd=5)+i)),
#                 1/(1+2^(rnorm(1,sd=5)+0)),
#                 1/(1+2^(rnorm(1,sd=5)-i)),0.2)
#     #col2 <- rgb(1/(1+2^(rnorm(1,sd=5)+0)),
#     #            1/(1+2^(rnorm(1,sd=5)+0)),
#     #            1/(1+2^(rnorm(1,sd=5)-i)),0.1)
#     line_vector_x <- c(x)
#     line_vector_y <- c(y)
#     for(k in 1:400){
#       x <- x + rnorm(1,sd=0.3/i)*sign1#runif(1,0,0.5)#*sign1#abs(rnorm(1,sd=0.5))*sign1
#       y <- y + rnorm(1,sd=0.3/i)*sign2##runif(1,0,0.5)#*sign2#abs(rnorm(1,sd=0.5))*sign2
#       line_vector_x <- c(line_vector_x,x)
#       line_vector_y <- c(line_vector_y,y)
#     }
#     polygon(line_vector_x,line_vector_y,col=col1,border=col1,lwd=1)
#   }
# }
#stop()
for(i in 1:100) {
pos1_bias <- rnorm(1,sd=5)#runif(1,-10,10)
pos2_bias <- rnorm(1,sd=5)#runif(1,-10,10)
col_bias_r <- runif(1,-6,6)
col_bias_g <- runif(1,-6,6)
col_bias_b <- runif(1,-6,6)
for (j in 1:25) {
reps <- runif(1,10,100)
d <- abs(rnorm(1,sd = 3,mean = 1))
point_vector <- c()
#vec <- c(0,d)
for (theta in ((1:reps) * 2 * pi) / reps) {
R <- rbind(c(cos(theta),-sin(theta)),c(sin(theta),cos(theta)))
vec <- c(0,runif(1,d - (d / 5),d + (d / 5)))
#vec[2] <- vec[2] - runif(1,-(d/100),(d/100))
point_vector <- rbind(point_vector,t(R %*% vec))
}
point_vector[,1] <-
point_vector[,1] + pos1_bias#rnorm(1,sd=3)
point_vector[,2] <-
point_vector[,2] + pos2_bias#rnorm(1,sd=3)
col1 <- rgb(1 / (1 + 2 ^ (rnorm(1,sd = 5) + col_bias_r - 2/d)),
1 / (1 + 2 ^ (rnorm(1,sd = 5) + col_bias_g)),
1 / (1 + 2 ^ (rnorm(1,sd = 5) + col_bias_b - 2/d)),0.03/(d^1.2+0.03))
polygon(point_vector,col = col1,border = col1,lwd = 1)
}
#points(t(matrix(R %*% t(vecs),nrow=2)))
}
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
point_vector
pos1_bias
0.5^0.5
0.1^0.1
0.5*log(0.5)
log10(5e-04)
source('~/Dropbox/Roth Lab/projects/twas_git/scripts/illustration/nn_draw.R', echo=TRUE)
source('~/Dropbox/Roth Lab/projects/twas_git/scripts/illustration/nn_draw.R', echo=TRUE)
source('~/Dropbox/Roth Lab/projects/twas_git/scripts/illustration/nn_draw.R', echo=TRUE)
source('~/Dropbox/Roth Lab/projects/twas_git/scripts/illustration/nn_draw.R', echo=TRUE)
source('~/Dropbox/Roth Lab/projects/twas_git/scripts/illustration/nn_draw.R', echo=TRUE)
source('~/Dropbox/Roth Lab/projects/twas_git/scripts/illustration/nn_draw.R', echo=TRUE)
source('~/Dropbox/Roth Lab/projects/twas_git/scripts/illustration/nn_draw.R', echo=TRUE)
